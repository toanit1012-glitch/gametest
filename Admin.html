<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Admin â€“ Poll Vote</title>

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

<style>
    body { font-family: Arial; margin: 20px; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ccc; padding: 6px; text-align: center; }
    th { background: #333; color: #fff; }
</style>
</head>
<body>

<h2>ğŸ“‹ Danh sÃ¡ch vote (Admin)</h2>

<button onclick="loadData()">ğŸ”„ Load láº¡i</button>

<table id="voteTable">
    <thead>
        <tr>
            <th>ID</th>
            <th>Category</th>
            <th>Choice</th>
            <th>Sender</th>
            <th>Thá»i gian</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>
<h3>ğŸ“Š Káº¿t quáº£ trá»±c quan</h3>
<canvas id="kingChart"></canvas>
<br>
<canvas id="queenChart"></canvas>
<script>
const API = "https://tri-viet.com.vn/User/Admin";

function loadData() {
    $.getJSON(API, function (data) {
        const tbody = $('#voteTable tbody');
        tbody.empty();

        data.forEach(x => {
            tbody.append(`
                <tr>
                    <td>${x.Id}</td>
                    <td>${x.Category}</td>
                    <td>${x.Choice}</td>
                    <td>${x.Sender}</td>
                    <td>${x.CreatedAt}</td>
                </tr>
            `);
        });
    });
}
 let kingChart, queenChart;
    const API1 = "https://tri-viet.com.vn/User";
    function loadResults() {
    $.getJSON(API1 + "/GetResults", function (data) {

        if (kingChart) kingChart.destroy();
        kingChart = new Chart(document.getElementById('kingChart'), {
            type: 'bar',
            data: {
                labels: data.King.map(x => x.Choice),
                datasets: [{
                    label: 'King Votes',
                    data: data.King.map(x => x.Count),
                    backgroundColor: '#28a745'
                }]
            }
        });

        if (queenChart) queenChart.destroy();
        queenChart = new Chart(document.getElementById('queenChart'), {
            type: 'bar',
            data: {
                labels: data.Queen.map(x => x.Choice),
                datasets: [{
                    label: 'Queen Votes',
                    data: data.Queen.map(x => x.Count),
                    backgroundColor: '#6f42c1'
                }]
            }
        });
    });
}
loadData();
loadResults();
</script>

</body>
</html>
<script>
   
</script>